{"version":3,"sources":["../src/kiteapi.js"],"names":["isFunction","thing","KiteApi","constructor","kite","auth","methods","setMethods","Object","assign","call","methodKeys","keys","hasMethod","method","includes","reduce","acc","methodName","setMethod","fn","func","undefined","Error","mustAuth","withArgs","authentication","responseCallback","args","Array","isArray","shouldAuthenticate"],"mappings":";;;;;;AAAA;;AACA;;;;;;AAEA,MAAMA,aAAaC,SAAS,OAAOA,KAAP,KAAiB,UAA7C;;AAEe,MAAMC,OAAN,CAAc;AAC3BC,cAAYC,IAAZ,EAAkB,EAAEC,IAAF,EAAQC,OAAR,EAAlB,EAAqC;AACnC,SAAKD,IAAL,GAAYA,IAAZ;AACA,SAAKC,OAAL,GAAe,KAAKC,UAAL,CACbC,OAAOC,MAAP,CAAc,EAAd,yBAA8B,eAAKC,IAAL,CAAUN,IAAV,EAAgBE,OAAhB,CAA9B,CADa,CAAf;AAGA,SAAKK,UAAL,GAAkBH,OAAOI,IAAP,CAAY,KAAKN,OAAjB,CAAlB;AACD;;AAEDO,YAAUC,MAAV,EAAkB;AAChB,QAAI,CAACA,MAAD,IAAWA,WAAW,EAA1B,EAA8B,OAAO,KAAP;AAC9B,WAAO,KAAKH,UAAL,CAAgBI,QAAhB,CAAyBD,MAAzB,CAAP;AACD;;AAEDP,aAAWD,OAAX,EAAoB;AAClB,WAAOE,OAAOI,IAAP,CAAYN,OAAZ,EAAqBU,MAArB,CAA4B,CAACC,GAAD,EAAMC,UAAN,KAAqB;AACtD,aAAOV,OAAOC,MAAP,CAAcQ,GAAd,EAAmB,KAAKE,SAAL,CAAeD,UAAf,EAA2BZ,QAAQY,UAAR,CAA3B,CAAnB,CAAP;AACD,KAFM,EAEJ,EAFI,CAAP;AAGD;;AAEDC,YAAUD,UAAV,EAAsBE,EAAtB,EAA0B;AACxB,QAAIf,IAAJ,EAAUgB,IAAV;;AAEA,QAAIrB,WAAWoB,EAAX,CAAJ,EAAoB;AAClBC,aAAOD,EAAP;AACAf,aAAOiB,SAAP;AACD,KAHD,MAGO,IAAItB,WAAWoB,GAAGC,IAAd,CAAJ,EAAyB;AAC9BA,aAAOD,GAAGC,IAAV;AACAhB,aAAOe,GAAGf,IAAV;AACD,KAHM,MAGA;AACL,YAAM,IAAIkB,KAAJ,CACH,+DADG,CAAN;AAGD;;AAEDlB,WAAOA,QAAQ,IAAR,GAAeA,IAAf,GAAsB,KAAKA,IAAlC;AACAgB,SAAKG,QAAL,GAAgBnB,QAAQ,IAAR,GAAeA,IAAf,GAAsB,IAAtC;;AAEA,WAAO;AACL,OAACa,UAAD,GAAc,CAAC,EAAEO,QAAF,EAAYC,cAAZ,EAA4BC,gBAA5B,EAA8CvB,IAA9C,EAAD,KAA0D;AACtE,cAAMwB,OAAOC,MAAMC,OAAN,CAAcL,QAAd,IAA0BA,QAA1B,GAAqC,CAACA,QAAD,CAAlD;AACAJ,aAAK,GAAGO,IAAR,EAAcD,gBAAd,EAAgC,EAAEvB,IAAF,EAAQsB,cAAR,EAAhC;AACD;AAJI,KAAP;AAMD;;AAEDK,qBAAmBjB,MAAnB,EAA2B;AACzB,WAAO,KAAKR,OAAL,CAAaQ,MAAb,KAAwB,KAAKR,OAAL,CAAaQ,MAAb,EAAqBU,QAApD;AACD;AAhD0B;kBAARtB,O","file":"kiteapi.js","sourcesContent":["import { DefaultApi } from './constants'\nimport wrap from './kite/wrap'\n\nconst isFunction = thing => typeof thing === 'function'\n\nexport default class KiteApi {\n  constructor(kite, { auth, methods }) {\n    this.auth = auth\n    this.methods = this.setMethods(\n      Object.assign({}, DefaultApi, wrap.call(kite, methods))\n    )\n    this.methodKeys = Object.keys(this.methods)\n  }\n\n  hasMethod(method) {\n    if (!method || method === '') return false\n    return this.methodKeys.includes(method)\n  }\n\n  setMethods(methods) {\n    return Object.keys(methods).reduce((acc, methodName) => {\n      return Object.assign(acc, this.setMethod(methodName, methods[methodName]))\n    }, {})\n  }\n\n  setMethod(methodName, fn) {\n    let auth, func\n\n    if (isFunction(fn)) {\n      func = fn\n      auth = undefined\n    } else if (isFunction(fn.func)) {\n      func = fn.func\n      auth = fn.auth\n    } else {\n      throw new Error(\n        `Argument must be a function or an object with a func property`\n      )\n    }\n\n    auth = auth != null ? auth : this.auth\n    func.mustAuth = auth != null ? auth : true\n\n    return {\n      [methodName]: ({ withArgs, authentication, responseCallback, kite }) => {\n        const args = Array.isArray(withArgs) ? withArgs : [withArgs]\n        func(...args, responseCallback, { kite, authentication })\n      },\n    }\n  }\n\n  shouldAuthenticate(method) {\n    return this.methods[method] && this.methods[method].mustAuth\n  }\n}\n"]}